<view class='ordertype'>
  <view class='ordertype-btn' style='color: {{themecolor.skintone}};border-color: {{themecolor.skintone}};'>商品订单</view>
  <view class='ordertype-btn' bindtap='reservation'>客房协议价</view>
  <view wx:if="{{roomService == 2}}" class='ordertype-btn' bindtap='kffw'>客房服务</view>
</view>
<view class='paddAll mgB30'>
  <scroll-view scroll-x class='typelist'>
    <view class='typebtn {{typeindex==3?"typeactive":""}}' data-num='3' bindtap='changetype'>待支付</view>
    <view class='typebtn {{typeindex=="all"?"typeactive":""}}' data-num='all' bindtap='changetype'>全部</view>
    <view class='typebtn {{typeindex==0?"typeactive":""}}' data-num='0' bindtap='changetype'>待商家确认</view>
    <view class='typebtn {{typeindex==1?"typeactive":""}}' data-num='1' bindtap='changetype'>已确认</view>
    <view class='typebtn {{typeindex==2?"typeactive":""}}' data-num='2' bindtap='changetype'>已发货</view>
  </scroll-view>
</view>
<block wx:if="{{datanull}}"> <!-- 无数据 -->
  <view class='datanull-font'>
    <image src='../../img/my-btnimg17.png' class='iconimg1' mode='widthFix'></image>
    <text>您还没有相关订单!</text>
  </view>
</block>
<block wx:else>  <!-- 有数据 -->
  <block wx:if="{{typeindex=='3'}}"><!-- 待支付 -->
    <include src="waitpay.wxml" />
  </block>
  <block wx:else> <!-- 非待支付状态 -->
    <block wx:for="{{listdata}}" wx:key="index"> <!-- 渲染数据 -->
      <block wx:if="{{typeindex=='all'}}">  <!-- 全部 -->
        <!-- 智能迷你吧 -->
        <block wx:if="{{item.delivWay=='3' && item.delivType=='0'}}" >  
          <view class='bgfff orderlist'>
            <view data-orderid="{{item.id}}">
              <view class='orderlistbox borderB'>
                <view class='font-name'>智能迷你吧</view>
              </view>
              <view class='orderlistbox-c nopadding' wx:for="{{item.orderDeliveryDetailDTOList}}" wx:for-item="childitem" wx:key="index">
                <view class='contentbox1'>
                  <image wx:if="{{childitem.prodHotelProductDTO.prodLogoUrl!=''&&childitem.prodHotelProductDTO.prodLogoUrl!=null}}" src='{{childitem.prodHotelProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <image wx:else src='{{childitem.prodProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <view class='font-content'>
                    <view wx:if="{{childitem.prodHotelProductDTO.prodShowName!=''&&childitem.prodHotelProductDTO.prodShowName!=null}}" class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitem.prodHotelProductDTO.prodShowName}}</view>
                    <view wx:else class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitem.prodProductDTO.prodShowName}}</view>
                    <view class='font-name2 alignright' style='width: 100%;'>¥ {{childitem.prodPrice}}</view>
                  </view>
                  <view class='font-name2 font-width'>x {{childitem.prodCount}}</view>
                </view>
                <view class='orderlistbox borderB bortop'>
                  <view class='font-name ordertime'>{{item.payTime}}</view>
                </view>
                <!-- 再次打开等按钮 -->
                <view class='orderlistbox borderB nobotborder' wx:if="{{item.delivType != 2}}">
                  <view class='btnwrap nobotborder'>
                    <text class="btnitem" catchtap="openagain" data-orderDetailId="{{childitem.orderDetailId}}">再次打开</text> 
                    <text class="btnitem" wx:if="{{item.isCabCs == 1}}" catchtap="after" data-cabid="{{item.cabId}}" data-deliid="{{item.id}}" data-roomcode="{{item.roomCode}}" data-delivcode="{{item.delivCode}}" data-devidetailid="{{childitem.id}}" data-prodcode="{{childitem.prodCode}}">申请售后</text>
                    <text wx:if="{{item.isRemark == 0}}" class="btnitem commentbtn" data-id="{{item.id}}" catchtap="postpj">评价</text>
                  </view>
                </view>
                <!-- 再次打开按钮 -->
              </view>
            </view>
          </view>
        </block>
        <!-- 智能迷你吧 -->
        <!-- 订单 -->
        <block wx:if="{{item.delivWay!='3'}}">
          <view class='bgfff orderlist'>
            <view data-orderid="{{item.id}}" bindtap='checkDetails'>
              <view class='orderlistbox borderB'>
                <view class='font-name'>订单编号 {{item.delivCode}}</view>
                <view class='font-name font-color1'>
                  <text wx:if="{{item.status=='0'}}">待确认</text>
                  <text wx:if="{{item.status=='1'}}">已确认</text>
                  <text wx:if="{{item.status=='2'}}">已发货</text>
                  <text wx:if="{{item.status=='3'}}">部分退款</text>
                  <text wx:if="{{item.status=='4'}}">全部退款</text>
                  <text wx:if="{{item.status=='5'}}">已收货</text>
                </view>
              </view>
              <view wx:if="{{item.delivType!=1}}" class='orderlistbox-c' wx:for="{{item.orderDeliveryDetailDTOList}}" wx:for-item="childitemtwo" wx:key="index">
                <view class='contentbox1'>
                  <image wx:if="{{childitemtwo.prodHotelProductDTO.prodLogoUrl!=''&&childitemtwo.prodHotelProductDTO.prodLogoUrl!=null}}" src='{{childitemtwo.prodHotelProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <image wx:else src='{{childitemtwo.prodProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <view class='font-content'>
                    <view wx:if="{{childitemtwo.prodHotelProductDTO.prodShowName!=''&&childitemtwo.prodHotelProductDTO.prodShowName!=null}}" class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitemtwo.prodHotelProductDTO.prodShowName}}</view>
                    <view wx:else class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitemtwo.prodProductDTO.prodShowName}}</view>
                    <view class='font-name2 alignright' style='width: 100%;'>¥ {{childitemtwo.prodPrice}}</view>
                  </view>
                  <view class='font-name2 font-width'>x {{childitemtwo.prodCount}}</view>
                </view>
              </view>
              <!-- 客房服务配送 -->
              <view wx:if="{{item.delivType==1}}" class='orderlistbox-c'>
                <view class='contentbox1'>
                  <image src='{{item.rmavcRecordsDto.hotelCategoryPicUrl}}' class='spimg' mode='aspectFill'></image>
                  <view class='font-content' style="width:calc(100% - 170rpx)">
                    <view class='font-name font-overflow fontcolor' style='width: 100%;'>{{item.rmavcRecordsDto.hotelCategoryName}}</view>
                  </view>
                </view>
              </view>
              <!-- 客房服务配送 -->
            </view>
            <view class='orderlistbox borderB'>
              <view class='font-name ordertime'>{{item.createdAt}}</view>
            </view>
            <block wx:if="{{item.status== 1 || item.status== 2}}">
              <view class='orderlistbox nobotborder' wx:if="{{item.isRemark == 0 && item.delivType == 0}}">
                <view class='btnwrap nobotborder'>
                  <text class="btnitem commentbtn" data-id="{{item.id}}" catchtap="postpj">评价</text>
                </view>
              </view>
            </block>
          </view>
          </block>
          <!-- 订单 -->
        </block>
        <block wx:if="{{typeindex!='all'}}">  <!-- 非全部 -->
        <!-- 订单 -->
        <block wx:if="{{item.delivWay!='3'}}">
          <view class='bgfff orderlist'>
            <view data-orderid="{{item.id}}" bindtap='checkDetails'>
              <view class='orderlistbox borderB'>
                <view class='font-name'>订单编号 {{item.delivCode}}</view>
                <view class='font-name font-color1'>
                  <text wx:if="{{item.status=='0'}}">待确认</text>
                  <text wx:if="{{item.status=='1'}}">已确认</text>
                  <text wx:if="{{item.status=='2'}}">已发货</text>
                  <text wx:if="{{item.status=='3'}}">部分退款</text>
                  <text wx:if="{{item.status=='4'}}">全部退款</text>
                  <text wx:if="{{item.status=='5'}}">已收货</text>
                </view>
              </view>
              <view wx:if="{{item.delivType!=1}}" class='orderlistbox-c' wx:for="{{item.orderDeliveryDetailDTOList}}" wx:for-item="childitemtwo" wx:key="index">
                <view class='contentbox1'>
                  <image wx:if="{{childitemtwo.prodHotelProductDTO.prodLogoUrl!=''&&childitemtwo.prodHotelProductDTO.prodLogoUrl!=null}}" src='{{childitemtwo.prodHotelProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <image wx:else src='{{childitemtwo.prodProductDTO.prodLogoUrl}}' class='spimg' mode='aspectFill'></image>
                  <view class='font-content'>
                    <view wx:if="{{childitemtwo.prodHotelProductDTO.prodShowName!=''&&childitemtwo.prodHotelProductDTO.prodShowName!=null}}" class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitemtwo.prodHotelProductDTO.prodShowName}}</view>
                    <view wx:else class='font-name font-overflow fontcolor' style='width: 100%;'>{{childitemtwo.prodProductDTO.prodShowName}}</view>
                    <view class='font-name2 alignright' style='width: 100%;'>¥ {{childitemtwo.prodPrice}}</view>
                  </view>
                  <view class='font-name2 font-width'>x {{childitemtwo.prodCount}}</view>
                </view>
              </view>
              <!-- 客房服务配送 -->
              <view wx:if="{{item.delivType==1}}" class='orderlistbox-c'>
                <view class='contentbox1'>
                  <image src='{{item.rmavcRecordsDto.hotelCategoryPicUrl}}' class='spimg' mode='aspectFill'></image>
                  <view class='font-content' style="width:calc(100% - 170rpx)">
                    <view class='font-name font-overflow fontcolor' style='width: 100%;'>{{item.rmavcRecordsDto.hotelCategoryName}}</view>
                  </view>
                </view>
              </view>
              <!-- 客房服务配送 -->
            </view>
            <view class='orderlistbox borderB'>
              <view class='font-name ordertime'>{{item.payTime}}</view>
            </view>
            <block wx:if="{{item.status== 1 || item.status== 2}}">
              <view class='orderlistbox nobotborder' wx:if="{{item.isRemark == 0 && item.delivType == 0}}">
                <view class='btnwrap nobotborder'>
                  <text class="btnitem commentbtn" data-id="{{item.id}}" catchtap="postpj">评价</text>
                </view>
              </view>
            </block>
          </view>
        </block>
        <!-- 订单 -->
      </block>
    </block>
  </block>
</block>