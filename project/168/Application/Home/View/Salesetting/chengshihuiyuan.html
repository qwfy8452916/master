<extend name="Main:baseTemplate" />
<block name="title">
	<title>案例管理 - 控制台</title>
</block>
<block name="style">
	<link rel="stylesheet" href="{:C('168NEW_URL')}/assets/common/js/plugins/select2/select2.min.css?v={:C('STATIC_VERSION')}">
	<link rel="stylesheet" type="text/css" href="{:C('168NEW_URL')}/assets/common/css/select2_metro.css?v={:C('STATIC_VERSION')}" />
	<link rel="stylesheet" type="text/css" href="/assets/common/js/plugins/datetimepicker/datepicker.css?v={:C('STATIC_VERSION')}" />
	<link rel="stylesheet" href="{:C('168NEW_URL')}/assets/common/css/global.css?v={:C('STATIC_VERSION')}">
</block>
<block name="content">

	<section class="content-header">
		<h1>城市会员指标</h1>
		<ol class="breadcrumb">
			<li>
				<a href="/"><i class="fa fa-dashboard"></i> 会员统计概览</a>
			</li>
			<li class="active">
				<a href="/homecase">分单计划</a>
			</li>
		</ol>
	</section>

	<section class="content">
        <div class="row">
            <div class="col-xs-12">
            	<div class="box box-default">
					<div class="box-body">
						<div class="row">
							<form class="form-horizontal" method="GET" action="/tongji/order_tel">
								<div class="col-xs-12 no-padding">
									<div class="col-xs-2">
										<div>会员名称：</div>
										<input type="text" name="date" class="form-control"  placeholder="会员名称" value="{$date}">
									</div>
									<div class="col-xs-2">
										<div>选择部门：</div>
										<select name="" class="form-control">
											<option value="">请选择</option>
											<option value="">商务</option>
											<option value="">客服</option>
										</select>
									</div>
									<div class="col-xs-2">
		                                <div>生效月份：</div>
		                                <div class="input-group">
		                                	<input type="text" name="date" class="form-control datepicker" style="border-radius:0 !important;" placeholder="选择月份" value="{$date}">
		                                	<span class="input-group-addon" id="basic-addon1"><i class="fa fa-calendar"></i></span>
		                                </div>
		                            </div>
		                            <div class="col-xs-2">
										<div>选择操作人：</div>
										<select name="" class="form-control">
											<option value="">请选择</option>
											<option value="">某某</option>
											<option value="">某某</option>
										</select>
									</div>
								</div>
                                <div class="col-xs-12 no-padding" style="padding-top: 20px !important;">
	                                <div class="col-xs-4">
	                                	<button type="button" class="btn btn-primary">新增</button>
										<button type="button" class="btn btn-success">下载模板</button>
										<button type="button" class="btn btn-info">导入</button>
	                                </div>
	                                <div class="col-xs-2 pull-right">
	                                	<button type="button" class="btn btn-primary pull-left">查询</button>
										<button type="button" class="btn btn-success pull-right hideLoading">导出</button>
	                                </div>
                                </div>
							</form>
						</div>
					</div>
				</div>
				<style>
					.city-content,.num-content,.time-content{display: none;}
					thead tr th{background: #3399cc;color: #fff;}
				</style>
				<div class="box box-default">
					<div class="box-body">
						<div class="row">
							<div class="col-sm-12">
								<table id="" class="table table-bordered table-hover dataTable no-footer" role="grid" >
			                        <thead>
			                            <tr role="row">
			                            	<th class="" tabindex="0" >城市</th>
			                            	<th class="" tabindex="0" >部门</th>
			                            	<th class="" tabindex="0" >会员指标 <i class="fa fa-unsorted"></i></th>
			                            	<th class="" tabindex="0" >生效月份 <i class="fa fa-unsorted"></i></th>
			                            	<th class="" tabindex="0" >操作时间 <i class="fa fa-unsorted"></i></th>
			                            	<th class="" tabindex="0" >操作人</th>
			                            	<th class="" tabindex="0" >操作</th>
			                            </tr>
			                        </thead>
			                        <tbody>
			                            <tr role="row" class="odd">
			                                <td class="sel-city">
			                                	<span class="city-text">北京</span>
				                                <div class="city-content">
					                                <select type="text" class="form-control">
														<option >北京</option>
														<option >上海</option>
														<option >南京</option>
														<option >广东</option>
													</select>
												</div>
											</td>
			                                <td>商务</td>
			                                <td class="sel-num">
			                                	<span class="num-text">2</span>
												<div class="num-content">
													<select type="text" class="form-control">
														<option>1</option>
														<option>2</option>
														<option>3</option>
													</select>
												</div>
			                                </td>
			                                <td class="sel-time">
			                                	<span class="time-text">2016-12</span>
												<input type="text" name="date" class="form-control datepicker-in time-content" style="border-radius:0 !important;" placeholder="选择月份" value="{$date}">
			                                </td>
			                                <td class="revise-time">2016-12-12</td>
			                                <td>某某</td>
			                                <td class="revise"><a href="javascript:;">修改</a></td>
			                            </tr>
			                            <tr role="row" class="odd">
			                                <td class="sel-city">
			                                	<span class="city-text">北京</span>
				                                <div class="city-content">
					                                <select type="text" class="form-control">
														<option >北京</option>
														<option >上海</option>
														<option >南京</option>
														<option >广东</option>
													</select>
												</div>
											</td>
			                                <td>商务</td>
			                                <td class="sel-num">
			                                	<span class="num-text">2</span>
												<div class="num-content">
													<select type="text" class="form-control">
														<option>1</option>
														<option>2</option>
														<option>3</option>
													</select>
												</div>
			                                </td>
			                                <td class="sel-time">
			                                	<span class="time-text">2016-12</span>
												<input type="text" name="date" class="form-control datepicker-in time-content" style="border-radius:0 !important;" placeholder="选择月份" value="{$date}">
			                                </td>
			                                <td class="revise-time">2016-12-12</td>
			                                <td>某某</td>
			                                <td class="revise"><a href="javascript:;">修改</a></td>
			                            </tr>
			                            <tr role="row" class="odd">
			                                <td class="sel-city">
			                                	<span class="city-text">北京</span>
				                                <div class="city-content">
					                                <select type="text" class="form-control">
														<option >北京</option>
														<option >上海</option>
														<option >南京</option>
														<option >广东</option>
													</select>
												</div>
											</td>
			                                <td>商务</td>
			                                <td class="sel-num">
			                                	<span class="num-text">2</span>
												<div class="num-content">
													<select type="text" class="form-control">
														<option>1</option>
														<option>2</option>
														<option>3</option>
													</select>
												</div>
			                                </td>
			                                <td class="sel-time">
			                                	<span class="time-text">2016-12</span>
												<input type="text" name="date" class="form-control datepicker-in time-content" style="border-radius:0 !important;" placeholder="选择月份" value="{$date}">
			                                </td>
			                                <td class="revise-time">2016-12-12</td>
			                                <td>某某</td>
			                                <td class="revise"><a href="javascript:;">修改</a></td>
			                            </tr>
			                        </tbody>
			                    </table>
		                    </div>
						</div>
					</div>
				</div>
            </div>
        </div>
    </section>
</block>
<block name="script">
	<script src="{:C('168NEW_URL')}/assets/common/js/plugins/select2/select2.js?v={:C('STATIC_VERSION')}"></script>
	<script src="{:C('168NEW_URL')}/assets/common/js/plugins/datetimepicker/bootstrap-datepicker.js?v={:C('STATIC_VERSION')}"></script>
	<script src="{:C('168NEW_URL')}/assets/common/js/select2.min.js?v={:C('STATIC_VERSION')}"></script>
	<script type="text/javascript">
		$(function() {
			$(".datepicker").datetimepicker({
				startView:3,
				minView:'decade',
				format:"yyyy-mm",
				autoclose:true,
				pickerPosition: "bottom-left"
			});

			
			var cityVal,numVal,timeVal;
			$('.revise').each(function(index, el) {
				$(this).on('click', function(){
					var $this = $(this);
					if($(this).find('a').html() == '保存'){
						$(this).find('a').html('修改').css('color','');
						// 城市选择
						if(cityVal){
							if(cityVal != $(this).parent().find(".city-text").text() && cityVal != '选择'){
								$(this).parent().find(".city-content").siblings().html(cityVal);
							}
						}
						// 倍数选择
						if(numVal){
							if(numVal != $(this).parent().find(".num-text").text() && numVal != '选择'){
								$(this).parent().find(".num-content").siblings().html(numVal);
							}
						}
						// 时间选择
						timeVal = $(this).parent().find('.time-content').val()
						if(timeVal != $(this).parent().find(".time-text").text() && timeVal){
							$(this).parent().find(".time-text").html(timeVal) 
						}
						
						$(this).parent().find(".city-content").hide().siblings().show();
						$(this).parent().find(".num-content").hide().siblings().show();
						$(this).parent().find(".time-content").hide().datetimepicker('remove').siblings().show();
						
						var now = new Date(),
						nowYear = now.getFullYear(),
						nowMonth = now.getMonth()+1,
						nowDay = now.getDate();
						// 操作时间选择
						$(this).parent().find(".revise-time").html(nowYear+'-'+nowMonth+'-'+nowDay)

					}else{
						// 城市选择
						$this.parent().find(".city-content").find("select").change(function(){
							cityVal = $(this).val();
						});
						// 倍数选择
						$this.parent().find(".num-content").find("select").change(function(){
							numVal = $(this).val();
						});

						$(this).find('a').html('保存').css('color','green');
						$(this).parent().find(".city-content").show().siblings().hide();
						$(this).parent().find(".num-content").show().siblings().hide();
						$(this).parent().find(".time-content").show().datetimepicker({
							startView:3,
							minView:'decade',
							format:"yyyy-mm",
							autoclose:true,
							pickerPosition: "bottom-left"
						}).siblings().hide();
						
					}
				})
			});
		});
	</script>
</block>