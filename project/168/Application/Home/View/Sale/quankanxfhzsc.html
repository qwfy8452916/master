<extend name="Main:baseTemplate" />
<block name="title">
	<title>全瞰-续费合作时长</title>
</block>
<block name="style">
	<link rel="stylesheet" href="{:C('168NEW_URL')}/assets/common/js/plugins/select2/select2.min.css?v={:C('STATIC_VERSION')}">
	<link rel="stylesheet" type="text/css" href="{:C('168NEW_URL')}/assets/common/css/select2_metro.css?v={:C('STATIC_VERSION')}" />
	<link rel="stylesheet" type="text/css" href="/assets/common/js/plugins/datetimepicker/datepicker.css?v={:C('STATIC_VERSION')}" />
	<link rel="stylesheet" type="text/css" href="/assets/home/css/xs-gangwei.css?v={:C('STATIC_VERSION')}">
</block>
<block name="content">
	<section class="content-header">
		<h1><i class="xs-icon xfhzsc-icon"></i>全瞰-续费合作时长</h1>
	</section>
	<section class="content section2">
		<form class="form-horizontal">
			<div class="from-list">
				<div class="from-item">
					<span class="width-auto">部门：</span>
					<select>
						<option value="">请选择</option>
						<option value="商务">营销中心</option>
						<option value="商务">商务</option>
						<option value="外销">外销</option>
					</select>
				</div>
				<div class="from-item" >
					<span class="timer-tit">财年：</span>
					<input type="text" name="date" class="form-control datepicker timer-input" placeholder="选择年份" value="">
					<i class="fa fa-calendar timer-icon"></i>
				</div>
				<button class="search-btn xs-btn">查询</button>
			</div>
		</form>
    </section>
    <section class="content section3 oflow">
		<div class="section3-sel">
			<div class="todo-item">
				<div class="pull-right position-relative">
					<i class="xs-icon zhushi-icon"></i>
					<div class="zhushi-info">
						<p>输入人注意事项：本页数据以部门及月份为唯一标识，其他数据均为部门及月份附属信息</p>
						<p>默认显示数据为：部门=“营销中心”的记录（每年的2月到次年1月）</p>
						<p>名词解释：（当月的数据：当月1日凌晨0.10到当日凌晨0:10，之前月数据：统计当月1日凌晨0.10到次月1日凌晨0：10）</p>
						<p>所有百分比类型的是指全部为：XX.X%，即取值小数点后1位，比如：90.17%取值90.2%，90.14%取值90.1%四舍五入。</p>
						<p>以下“营销中心”数值为：（除占比外）外销部和商务部的总计</p>
						<p>1、续费数≥1年：当月续费会员，本次合同开始日到本次合同结束日≥365天</p>
						<p>2、1年＞续费数≥0.5年：当月续费会员，本次合同开始日到本次合同结束日，365＞续费数≥182天</p>
						<p>3、0.5年＞续费数≥0.25年：当月续费会员，本次合同开始日到本次合同结束日，182＞续费数≥90天</p>
						<p>4、续费数＜0.25年：当月续费会员，本次合同开始日到本次合同结束日，续费数＜90天</p>
						<p>5、占比：合作时长续费数/总数*100%</p>
						<p>6、中途暂停：暂停期间内不计入会员数和总数</p>
						<p>7、退费：退费后不计入会员数和总数</p>
						<p>8、新签：根据会员ID号取值，本次合同开始日与上次合作的本次合同结束日间隔天数，间隔天数＞180天，或无合作过的会员属于新签</p>
						<p>9、续费：根据会员ID号取值，本次合同开始日与上次合作的本次合同结束日间隔天数，间隔天数≤180天的会员属于续费</p>
						<p>10、当月数据显示：以当月1日凌晨0.10到当日凌晨0:10的数值显示，比如4月16日当天数据显示为4月1日凌晨0：10到4月16日凌晨0：10的数值，分析<p>折线图不显示4月数值。</p>
						<p>11、所有统计数值，取次月1日凌晨0：10的数值定格保存。</p>
					</div>
				</div>
			</div>
			<table id="" class="table table-bordered table-hover dataTable no-footer" role="grid" >
                <thead>
                    <tr role="row">
                    	<th class="" tabindex="0" >财年</th>
                    	<th class="" tabindex="0" >续费数≥1年</th>
                    	<th class="" tabindex="0" >占比</th>
                    	<th class="" tabindex="0" >1年＞续费数≥0.5年</th>
                    	<th class="" tabindex="0" >占比</th>
                    	<th class="" tabindex="0" >0.5年＞续费数≥0.25年</th>
                    	<th class="" tabindex="0" >占比</th>
                    	<th class="" tabindex="0" >续费数＜0.25年</th>
                    	<th class="" tabindex="0" >占比</th>
                    	<th class="" tabindex="0" >续费总数（个）</th>
                    </tr>
                </thead>
                <tbody>
                    <tr role="row" class="odd">
                        <td><span>2017-06</span></td>
						<td><span>商务</span></td>
						<td>
							<span>3</span>
						</td>
						<td>
							<span>4</span>
						</td>
						<td>
							<span>80%</span>
						</td>
						<td>
							<span>80%</span>
						</td>
						<td>
							<span>80%</span>
						</td>
						<td>
							<span>80%</span>
						</td>
						<td>
							<span>80%</span>
						</td>
						<td>
							<span>8</span>
						</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="col-xs-12 no-padding max-width-1352">
        	<div id="canvas" class="col-xs-6 no-padding canvas-height-300">
			</div>
			<div id="canvas1" class="col-xs-6 no-padding canvas-height-300">
			</div>
			<div id="canvas2" class="col-xs-6 no-padding canvas-height-300">
			</div>
			<div id="canvas3" class="col-xs-6 no-padding canvas-height-300">
			</div>
        </div>
    </section>
</block>
<block name="script">
	<script src="https://cdn.bootcss.com/echarts/3.5.4/echarts.js?v={:C('STATIC_VERSION')}"></script>
	<script type="text/javascript">
		$(function() {
			
			// canvas
			var dom = document.getElementById("canvas");
			var dom1 = document.getElementById("canvas1");
			var dom2 = document.getElementById("canvas2");
			var dom3 = document.getElementById("canvas3");

			var myChart = echarts.init(dom);
			var myChart1 = echarts.init(dom1);
			var myChart2 = echarts.init(dom2);
			var myChart3 = echarts.init(dom3);
			// 会员数 ≥ 1年占比的同比 [参数项]
			var option = {
			    title : {
			        text: '续费数 ≥ 1年占比的同比',
			        subtext: '会员数',
			        textStyle:{
					    color: '#359bed'
					}
			    },
			    tooltip : {
			        trigger: 'axis'
			    },
			    legend: {
			        data:['2017年实际会员数','2016年实际会员数'],
			        right:'60'
			    },
			    calculable : true,
			    xAxis : [
			        {
			            type : 'category',
			            boundaryGap : true,
			            data : ['01','02','03','04','05','06','07','08','09','10','11','12']
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value',
			            axisLabel : {
			                formatter: '{value}'
			            },
			            splitArea:{
				    		show:true,
				    		onGap:'boundaryGap',
				    		areaStyle:{
							    color: [
							        'rgba(250,250,250,0.3)',
							        'rgba(200,200,200,0.3)'
							    ]
							}
				    	}
			        }
			    ],
			    axis:{

			    },
			    series : [
			        {
			            name:'2017年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[110, 120, 540, 320, 420, 430, 100,821,259,200,871,309],
                        itemStyle: {
				            normal: {
				                color: "#359bed",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        },
			        {
			            name:'2016年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[160, 200, 500, 510, 300, 250,50,1000,700,910,300,350],
                        itemStyle: {
				            normal: {
				                color: "#f5994e",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        }
			    ]
			};
			// 1年 ≥ 会员数 ≥ 0.5年占比的同比 [参数项]
			var option1 = {
			    title : {
			        text: '1年 ≥ 续费数 ≥ 0.5年占比的同比',
			        subtext: '会员数',
			        textStyle:{
					    color: '#359bed'
					}
			    },
			    tooltip : {
			        trigger: 'axis'
			    },
			    legend: {
			        data:['2017年实际会员数','2016年实际会员数'],
			        right:'60'
			    },
			    calculable : true,
			    xAxis : [
			        {
			            type : 'category',
			            boundaryGap : true,
			            smooth:true,
			            data : ['01','02','03','04','05','06','07','08','09','10','11','12']
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value',
			            axisLabel : {
			                formatter: '{value}'
			            },
			            splitArea:{
				    		show:true,
				    		onGap:'boundaryGap',
				    		areaStyle:{
							    color: [
							        'rgba(250,250,250,0.3)',
							        'rgba(200,200,200,0.3)'
							    ]
							}
				    	}
			        }
			    ],
			    series : [
			        {
			            name:'2017年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[110, 120, 540, 320, 420, 430, 100,821,259,200,871,309],
			            itemStyle: {
				            normal: {
				                color: "#359bed",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        },
			        {
			            name:'2016年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[160, 200, 500, 510, 300, 250,50,1000,700,910,300,350],
			            itemStyle: {
				            normal: {
				                color: "#f5994e",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        }
			    ]
			};
			// 0.5年 ≥ 会员数 ≥ 0.25年占比的同比 [参数项]
			var option2 = {
			    title : {
			        text: '0.5年 ≥ 续费数 ≥ 0.25年占比的同比',
			        subtext: '会员数',
			        textStyle:{
					    color: '#359bed'
					}
			    },
			    tooltip : {
			        trigger: 'axis'
			    },
			    legend: {
			        data:['2017年实际会员数','2016年实际会员数'],
			        right:'60'
			    },
			    calculable : true,
			    xAxis : [
			        {
			            type : 'category',
			            boundaryGap : true,
			            smooth:true,
			            data : ['01','02','03','04','05','06','07','08','09','10','11','12']
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value',
			            axisLabel : {
			                formatter: '{value}'
			            },
			            splitArea:{
				    		show:true,
				    		onGap:'boundaryGap',
				    		areaStyle:{
							    color: [
							        'rgba(250,250,250,0.3)',
							        'rgba(200,200,200,0.3)'
							    ]
							}
				    	}
			        }
			    ],
			    series : [
			        {
			            name:'2017年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[110, 120, 540, 320, 420, 430, 100,821,259,200,871,309],
			            itemStyle: {
				            normal: {
				                color: "#359bed",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        },
			        {
			            name:'2016年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[160, 200, 500, 510, 300, 250,50,1000,700,910,300,350],
			            itemStyle: {
				            normal: {
				                color: "#f5994e",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        }
			    ]
			};
			// 会员数 ≤ 0.25年占比的同比 [参数项]
			var option3 = {
			    title : {
			        text: '续费数 ≤ 0.25年占比的同比',
			        subtext: '会员数',
			        textStyle:{
					    color: '#359bed'
					}
			    },
			    tooltip : {
			        trigger: 'axis'
			    },
			    legend: {
			        data:['2017年实际会员数','2016年实际会员数'],
			        right:'60'
			    },
			    calculable : true,
			    xAxis : [
			        {
			            type : 'category',
			            boundaryGap : true,
			            smooth:true,
			            data : ['01','02','03','04','05','06','07','08','09','10','11','12']
			        }
			    ],
			    yAxis : [
			        {
			            type : 'value',
			            axisLabel : {
			                formatter: '{value}'
			            },
			            splitArea:{
				    		show:true,
				    		onGap:'boundaryGap',
				    		areaStyle:{
							    color: [
							        'rgba(250,250,250,0.3)',
							        'rgba(200,200,200,0.3)'
							    ]
							}
				    	}
			        }
			    ],
			    series : [
			        {
			            name:'2017年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[110, 120, 540, 320, 420, 430, 100,821,259,200,871,309],
			            itemStyle: {
				            normal: {
				                color: "#359bed",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        },
			        {
			            name:'2016年实际会员数',
			            type:'line',
			            smooth:true,
			            data:[160, 200, 500, 510, 300, 250,50,1000,700,910,300,350],
			            itemStyle: {
				            normal: {
				                color: "#f5994e",  // 会设置点和线的颜色，所以需要下面定制 line
				            }
				        },
			            markPoint : {
			                data : [
			                    {type : 'max', name: '最大值'},
			                    // {type : 'min', name: '最小值'}
			                ]
			            }
			        }
			    ]
			};     
			myChart.setOption(option, true); 
			myChart1.setOption(option1, true);
			myChart2.setOption(option2, true);
			myChart3.setOption(option3, true);
			// 窗口缩放canvas重新渲染
			$(window).on('resize',function(){
				var myChart = echarts.init(dom);
				var myChart1 = echarts.init(dom1);
				var myChart2 = echarts.init(dom2);
				var myChart3 = echarts.init(dom3);
				myChart.setOption(option, true); 
				myChart1.setOption(option1, true);
				myChart2.setOption(option2, true);
				myChart3.setOption(option3, true);	
			});
			// 时间选择
			$(".datepicker").datetimepicker({
				startView:4,
				minView:'decade',
				format:"yyyy",
				autoclose:true,
				pickerPosition: "bottom-left"
			});
			// 注释信息
			$('.zhushi-icon').hover(function() {
				$('.zhushi-info').show().css('z-index','1');
			}, function() {
				$('.zhushi-info').hide();
			});
		});
	</script>
</block>