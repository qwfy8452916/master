
<extend name="Main:baseTemplate" />
<block name="title">
    <title>质检工作量统计-控制台</title>
</block>
<block name="style">
<link rel="stylesheet" type="text/css" href="/assets/common/js/plugins/datetimepicker/datepicker.css?v={:C('STATIC_VERSION')}" />
<link rel="stylesheet" type="text/css" href="/assets/common/css/select2_metro.css?v={:C('STATIC_VERSION')}" />
<link rel="stylesheet" type="text/css" href="/assets/home/css/qc.css?v={:C('STATIC_VERSION')}" />
<link href="/assets/common/phpexcel/phpexcel.css?v={:C('STATIC_VERSION')}" rel="stylesheet">
<link href="/assets/common/phpexcel/handsontable.full.min.css?v={:C('STATIC_VERSION')}" rel="stylesheet">
</block>
<block name="content">
	<section class="content-header">
        <h1>质检工作量统计</h1>
    </section>
    <section class="content">
		<div class="row">
			<div class="col-xs-12">
                <div class="box">
                    <div class="row">
                        <form class="form-horizontal" method="GET">
                            <div class="col-xs-12">
                                <ul class="npoc-tab-wrap">
                                <li class="npoc-tab" data-tab='1'>
                                    <span style="font-size: 14px;">质检工作量</span>
                                </li>
                                <li class="npoc-tab" data-tab='2'>
                                    抽检工作量
                                </li>
                                <li class="npoc-tab" data-tab='3'>
                                    在线客服工作量
                                </li>
                                </ul>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
			<div class="col-xs-12" id="tab1">
				<div class="box box-default">
					<div class="box-header">
						<div class="col-xs-12">
							条件查询
						</div>
					</div>
					<div class="box-body">
						<form action="/qcstat/workstat" method="get" class="">
							<div class="form-group pull-left col-sm-12">
		                        <div class="col-xs-2">
	                                <label>选择时间：</label>
	                                <input class="form-control datepicker" type="text" name="begin" placeholder="选择开始时间" value="{$Think.get.begin}">
	                            </div>
 								<div class="col-xs-2">
	                                <label>&nbsp;</label>
	                                <input class="form-control datepicker" type="text" name="end" placeholder="选择结束时间" value="{$Think.get.end}">
	                            </div>
	                            <div class="col-xs-2">
									<label style="display: block;">&nbsp;</label>
	                               	<button id="btnSearch" type="submit" class="btn btn-primary btn-sm btn-flat  ml10"><i class="fa fa-search"></i>&nbsp;搜索</button>
	                               	<input type="hidden" name="index" value="1" />
	                            </div>
							</div>
	                	</form>
					</div>
				</div>
				<div class="box box-default">
					<div class="box-body">
						<table class="table table-bordered table-hover">
							<thead>
								<th>序号</th>
								<th>质检员</th>
								<th>抽查天数</th>
								<th>分单</th>
								<th>赠单</th>
								<th>无效单</th>
								<th>合计</th>
							</thead>
							<tbody>
								<volist name="list" id="vo">
								<tr>
									<td>{$key+1}</td>
									<td>{$vo.op_name}</td>
									<td>{$vo.count|default=0}</td>
									<td>{$vo.fen|default=0}</td>
									<td>{$vo.zen|default=0}</td>
									<td>{$vo.wx|default=0}</td>
									<td>{$vo.all|default=0}</td>
								</tr>
								</volist>
								<tr>
									<td>-</td>
									<td>汇总</td>
									<td>{$all.count|default=0}</td>
									<td>{$all.fen|default=0}</td>
									<td>{$all.zen|default=0}</td>
									<td>{$all.wx|default=0}</td>
									<td>{$all.all|default=0}</td>
								</tr>
							</tbody>
						</table>

					</div>
				</div>
				<div class="box box-default">
			        <div class="alert alert-warning">
			            <p>说明</p>
			        </div>
			    </div>
			</div>
			<div class="col-xs-12" id="tab2">
				<div class="box box-default">
					<div class="box-header">
						<div class="col-xs-12">
							条件查询
						</div>
					</div>
					<div class="box-body">
						<form action="/qcstat/workstat" method="get" class="">
							<div class="form-group pull-left col-sm-12">
		                        <div class="col-xs-2">
	                                <label>选择时间：</label>
	                                <input class="form-control datepicker" type="text" name="begin" placeholder="选择开始时间" value="{$Think.get.begin}">
	                            </div>
 								<div class="col-xs-2">
	                                <label>&nbsp;</label>
	                                <input class="form-control datepicker" type="text" name="end" placeholder="选择结束时间" value="{$Think.get.end}">
	                            </div>
	                            <div class="col-xs-2">
									<label style="display: block;">&nbsp;</label>
	                               	<button id="btnSearch" type="submit" class="btn btn-primary btn-sm btn-flat  ml10"><i class="fa fa-search"></i>&nbsp;搜索</button>
	                               	<input type="hidden" name="index" value="2" />
	                            </div>
							</div>
	                	</form>
					</div>
				</div>
				<div class="box box-default">
					<div class="box-body">
						<table class="table table-bordered table-hover">
							<thead>
								<th>序号</th>
								<th>质检员</th>
								<th>抽查天数</th>
								<th>分单</th>
								<th>赠单</th>
								<th>无效单</th>
								<th>合计</th>
							</thead>
							<tbody>
								<volist name="samplingList" id="vo">
								<tr>
									<td>{$key+1}</td>
									<td>{$vo.op_name}</td>
									<td>{$vo.count|default=0}</td>
									<td>{$vo.fen|default=0}</td>
									<td>{$vo.zen|default=0}</td>
									<td>{$vo.wx|default=0}</td>
									<td>{$vo.all|default=0}</td>
								</tr>
								</volist>
								<tr>
									<td>-</td>
									<td>汇总</td>
									<td>{$samplingAll.count|default=0}</td>
									<td>{$samplingAll.fen|default=0}</td>
									<td>{$samplingAll.zen|default=0}</td>
									<td>{$samplingAll.wx|default=0}</td>
									<td>{$samplingAll.all|default=0}</td>
								</tr>
							</tbody>
						</table>

					</div>
				</div>
				<div class="box box-default">
			        <div class="alert alert-warning">
			            <p>说明</p>
			        </div>
			    </div>
			</div>
			<div class="col-xs-12" id="tab3">
				<div class="box-body">
					<form action="/qcstat/workstat" method="get" class="">
						<div class="form-group pull-left col-sm-12">
	                        <div class="col-xs-2">
                                <label>选择时间：</label>
                                <input class="form-control datepicker" type="text" name="begin" placeholder="选择开始时间" value="{$Think.get.begin}">
                            </div>
								<div class="col-xs-2">
                                <label>&nbsp;</label>
                                <input class="form-control datepicker" type="text" name="end" placeholder="选择结束时间" value="{$Think.get.end}">
                            </div>
                            <div class="col-xs-1">
								<label style="display: block;">&nbsp;</label>
                               	<button id="btnSearch" type="submit" class="btn btn-primary btn-sm btn-flat  ml10"><i class="fa fa-search"></i>&nbsp;搜索</button>
                               	<input type="hidden" name="index" value="3" />
                            </div>
                            <div class="col-xs-1 pull-right text-center">
								<label style="display: block;">&nbsp;</label>
								<button id="btnSearch" type="button" class="btn btn-primary btn-sm btn-flat export  ml10"><i class="fa fa-search"></i>&nbsp;导出</button>
                            </div>
						</div>
                	</form>
				</div>
				<div class="box box-default">
					<div class="box-body">
						<table id="myTable" class="table table-bordered table-hover">
							<thead>
								<th>序号</th>
								<th>质检员</th>
								<th>抽查次数</th>
								<th>400客服次数</th>
								<th>53线客服次数</th>
							</thead>
							<tbody>
								<volist name="otherList" id="vo">
								<tr>
									<td>{$key+1}</td>
									<td>{$vo.name}</td>
									<td>{$vo.all}</td>
									<td>{$vo.400}</td>
									<td>{$vo.53}</td>
								</tr>
								</volist>
							</tbody>
						</table>

					</div>
				</div>
				<div class="box box-default">
			        <div class="alert alert-warning">
			            <p>说明</p>
			        </div>
			    </div>
			</div>
		</div>
	</section>
</block>
<block name="script">
<script type="text/javascript" src="{:C('168NEW_URL')}/assets/common/js/select2.min.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript" src="{:C('168NEW_URL')}/assets/common/js/plugins/datetimepicker/bootstrap-datepicker.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript" src="{:C('168NEW_URL')}/assets/common/js/echarts.min.js?v={:C('STATIC_VERSION')}"></script>
<script src="/assets/common/phpexcel/handsontable.full.min.js?v={:C('STATIC_VERSION')}"></script>
<script src="/assets/common/phpexcel/phpexcel.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript">
	$("#qc").select2();
	$("#qc").select2("val","{$Think.get.qc}");

	$(".datepicker").datepicker({
        format:"yyyy-mm-dd"
    });

	$('.npoc-tab-wrap li.npoc-tab').eq({$Think.get.index|default=1}-1).addClass('npoc-tab-active');
    //tab切换
    $('.npoc-tab').on('click', function() {
        $('.npoc-tab').removeClass('npoc-tab-active');
        $(this).addClass('npoc-tab-active');
        var tabIndex = $(this).attr('data-tab');
        $("#tab1,#tab2,#tab3").hide();
        $('#tab'+tabIndex).show();
    });
    $(".npoc-tab-active").trigger('click');

    $(".export").click(function(event) {
        var _this = $(this);
        var taget = $("#myTable");
        var colums = [];
        var data = [];
        taget.find("th").each(function() {
            var text = $(this).text().trim();
            var sub = [];
            sub["text"] = text;
            sub["fontColor"] = $(this).css("color");
            sub["bgColor"] = $(this).css("background-color");
            colums.push(sub);
        });
        data.push(colums);
        taget.find("tbody tr").each(function(i) {
            var tr = $(this);
            var sub = [];
            tr.find("td").each(function() {
                var text = $(this).text().trim();
                var _td = {
                    text: text,
                    fontColor: $(this).css("color"),
                    bgColor: $(this).css("background-color")
                }
                sub.push(_td);
            });
            data.push(sub);
        });

        _this.exportExcel({
            data: data,
            title: "在线客服工作量统计",
            url: "/export/download",
            show:true
        });
    });
</script>
</block>