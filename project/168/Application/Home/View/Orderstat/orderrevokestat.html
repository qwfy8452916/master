<extend name="Main:baseTemplate" />
<block name="title">
    <title>撤回单统计-控制台</title>
</block>
<block name="style">
    <link rel="stylesheet" type="text/css" href="/assets/home/css/customerordereffective.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" type="text/css" href="/assets/common/js/plugins/datetimepicker/datepicker.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" type="text/css" href="/assets/common/js/plugins/dataTables/dataTables.bootstrap.min.css?v={:C('STATIC_VERSION')}" />
</block>
<block name="content">
<section class="content-header">
    <h1>撤回单统计</h1>
    <ol class="breadcrumb">
        <li>
            <a href="/"><i class="fa fa-dashboard"></i> 控制面板</a>
        </li>
        <li>
            新客服分单统计
        </li>
    </ol>
</section>
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box">
                <div class="row">
                    <form class="form-horizontal" method="GET" action="/orderstat/customerordereffective/">
                        <div class="col-xs-12">
                            <ul class="npoc-tab-wrap">
                            <li class="npoc-tab" data-tab='1'>
                                <span style="font-size: 14px;">按人统计</span>
                            </li>
                            <li class="npoc-tab" data-tab='2'>
                                按组统计
                            </li>
                            <li class="npoc-tab" data-tab='3'>
                                按师统计
                            </li>
                            </ul>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-xs-12">
            <div class="box">
                <div class="box-header">
                    <form action="/orderstat/orderrevokestat" method="get">
                    <div class="col-xs-2">
                        <div>查询时间-开始:</div>
                        <input type="text" data-search='1' name="begin" class="form-control datepicker" placeholder="选择日期" value="{$Think.get.begin}">
                    </div>
                    <div class="col-xs-2">
                        <div>查询时间-结束:</div>
                        <input type="text" data-search='1' name="end" class="form-control datepicker" placeholder="选择日期" value="{$Think.get.end}">
                    </div>
                    <div class="col-xs-2 pull-right">
                        <div style="opacity:0;">查询</div>
                        <button type="submit" id="olSearch" class="btn-info form-control">查询</button>
                        <input type="hidden" name="index" value="1" />
                    </div>
                   <!--  <div class="col-xs-2 pull-right">
                        <div style="opacity:0;">导出EXCEL</div>
                        <button type="button" class="btn-success form-control export" data-tab="1">导出EXCEL</button>
                    </div> -->
                    </form>
                </div>
                <div class="box-body table-responsive no-padding" id="tab1">
                    <table id="myTable2" class="table table-hover table-bordered">
                        <thead>
                            <tr>
                                <th>客服姓名</th>
                                <th>推送总单数</th>
                                <th>撤回单数</th>
                                <th>撤回单率</th>
                                <th>撤回单分单量</th>
                                <th>撤回单赠单量</th>
                                <th>分改赠次数</th>
                                <th>赠改分次数</th>
                                <th>更改单平均修改次数</th>
                            </tr>
                        </thead>
                        <tbody>
                            <volist name="list.user" id="vo" key="key">
                             <tr>
                                <td>{$vo.name}</td>
                                <td>{$vo.all_count|default=0}</td>
                                <td>{$vo.revoke_count|default=0}</td>
                                <td>{$vo.revoke_rate|default=0}%</td>
                                <td>{$vo.fen_count|default=0}</td>
                                <td>{$vo.zen_count|default=0}</td>
                                <td>{$vo.turn_zen_count|default=0}</td>
                                <td>{$vo.turn_fen_count|default=0}</td>
                                <td>{$vo.avg_push|default=0}</td>
                            </tr>
                            </volist>
                        </tbody>
                    </table>
                </div>
                <div class="box-body table-responsive no-padding" id="tab2">
                    <table id="myTable2" class="table table-hover table-bordered">
                        <thead>
                            <tr>
                                <th>客服组</th>
                                <th>推送总单数</th>
                                <th>撤回单数</th>
                                <th>撤回单率</th>
                                <th>撤回单分单量</th>
                                <th>撤回单赠单量</th>
                                <th>分改赠次数</th>
                                <th>赠改分次数</th>
                                <th>更改单平均修改次数</th>
                            </tr>
                        </thead>
                        <tbody>
                            <volist name="list.group" id="vo" key="key">
                             <tr>
                                <td>{$vo.name}</td>
                                <td>{$vo.all_count|default=0}</td>
                                <td>{$vo.revoke_count|default=0}</td>
                                <td>{$vo.revoke_rate|default=0}%</td>
                                <td>{$vo.fen_count|default=0}</td>
                                <td>{$vo.zen_count|default=0}</td>
                                <td>{$vo.turn_zen_count|default=0}</td>
                                <td>{$vo.turn_fen_count|default=0}</td>
                                <td>{$vo.avg_push|default=0}</td>
                            </tr>
                            </volist>
                        </tbody>
                    </table>
                </div>
                <div class="box-body table-responsive no-padding" id="tab3">
                    <table id="myTable2" class="table table-hover table-bordered">
                        <thead>
                            <tr>
                                <th>客服师</th>
                                <th>推送总单数</th>
                                <th>撤回单数</th>
                                <th>撤回单率</th>
                                <th>撤回单分单量</th>
                                <th>撤回单赠单量</th>
                                <th>分改赠次数</th>
                                <th>赠改分次数</th>
                                <th>更改单平均修改次数</th>
                            </tr>
                        </thead>
                        <tbody>
                            <volist name="list.manager" id="vo" key="key">
                             <tr>
                                <td>{$vo.name}</td>
                                <td>{$vo.all_count|default=0}</td>
                                <td>{$vo.revoke_count|default=0}</td>
                                <td>{$vo.revoke_rate|default=0}%</td>
                                <td>{$vo.fen_count|default=0}</td>
                                <td>{$vo.zen_count|default=0}</td>
                                <td>{$vo.turn_zen_count|default=0}</td>
                                <td>{$vo.turn_fen_count|default=0}</td>
                                <td>{$vo.avg_push|default=0}</td>
                            </tr>
                            </volist>
                            <tr>
                                <th>汇总:</th>
                                <td>{$list.all.all_count|default=0}</td>
                                <td>{$list.all.revoke_count|default=0}</td>
                                <td>{$list.all.revoke_rate|default=0}%</td>
                                <td>{$list.all.fen_count|default=0}</td>
                                <td>{$list.all.zen_count|default=0}</td>
                                <td>{$list.all.turn_zen_count|default=0}</td>
                                <td>{$list.all.turn_fen_count|default=0}</td>
                                <td>{$list.all.avg_push|default=0}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-xs-12">
            <div class="alert alert-warning">
                <p>说明：</p>
                <p>推送的总单数：查询时间段内，推送到对接客服后台的所有订单  </p>
                <p>撤回单率=撤回单数/推送总单数</p>
                <p>分改赠次数：一个订单被撤回由分改赠计算一次  </p>
                <p>赠改分次数：一个订单从赠改成分计算一次</p>
                <p>更改单平均修改次数=订单撤回的总次数/更改的总单数</p>

            </div>
        </div>
</section>
</block>
<block name="script">
<script type="text/javascript" src="/assets/common/js/plugins/datetimepicker/bootstrap-datepicker.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/common/js/plugins/dataTables/jquery.dataTables.min.js?v={:C('STATIC_VERSION')}"></script>
<script type="text/javascript">

    $('#myTable2').DataTable({
       paging:false,
       searching:false,
       language:{
            zeroRecords: "没有内容",
            info:""
       },
       sWidth:"100%",
       scrollY:"600px"
    });
    $(".datepicker").datepicker({
       format:"yyyy-mm-dd"
    });
    $('.npoc-tab-wrap li.npoc-tab').eq({$Think.get.index|default=1}-1).addClass('npoc-tab-active');
    $('.npoc-tab').on('click', function() {
        $('.npoc-tab').removeClass('npoc-tab-active');
        $(this).addClass('npoc-tab-active');
        var tabIndex = $(this).attr('data-tab');
        $("#tab1,#tab2,#tab3").hide();
        $('#tab'+tabIndex).show();
    });

    $(".npoc-tab-active").trigger('click');
</script>
</block>
