{extend name="common:basic" /}
{block name="title"}
施工组管理
{/block}
{block name="link"}
<link rel="stylesheet" href="/assets/pc/js/Plugin/bootstrap/css/bootstrap.min.css?v={:config('STATIC_VERSION')}">
<link rel="stylesheet" href="/assets/pc/js/Plugin/select2/css/select2.min.css?v={:config('STATIC_VERSION')}">
<link rel="stylesheet" href="/assets/pc/css/Private/group.css?v={:config('STATIC_VERSION')}">
<link rel="stylesheet" href="/assets/pc/js/Plugin/select3/css/select3.css?v={:config('STATIC_VERSION')}">
{/block}
{block name="bread_title"}
<div class="titlewaik">施工班组</div>
{/block}
{block name="content"}
<div class="p-panel">
    <div class="staffwk">
        <form action="workgroup" id="search_form">
            <div class="formwaik">
                <div class="formdivitem firstdiv">
                    <span class="span-title">工人姓名：</span>
                    <div class="divinput"><input class="p-input staffname" type="text" name="name" value="{$Think.get.name|default=''}"
                            maxlength="11" placeholder="请输入"></div>
                </div>
                <div class="formdivitem">
                    <span class="span-title">工种：</span>
                    <div class="divinput">
                        <select class="p-input departmentxz" name="work_type" id="">
                            <option value="">请选择</option>
                            {volist name='worktypeSelect' id='vo'}
                            <option value="{$vo.id|default=''}" {if ($Think.get.work_type == $vo.id)}selected{/if}>{$vo.name}</option>
                            {/volist}
                        </select>
                    </div>
                </div>
                <div class="formdivitem firstdiv">
                    <span class="span-title">施工状态：</span>
                    <div class="divinput">
                        <select class="p-input staffname" name="work_status">
                            <option value="">请选择</option>
                            <option value="1" {if ($Think.get.work_status == 1)}selected{/if}>空闲中</option>
                            <option value="2" {if ($Think.get.work_status == 2)}selected{/if}>施工中</option>
                        </select>
                    </div>
                </div>
                <div class="formdivitem firstdiv">
                    <span class="span-title">启用状态：</span>
                    <div class="divinput">
                        <select class="p-input staffname" name="status">
                            <option value="">请选择</option>
                            <option value="1" {if ($Think.get.status == 1)}selected{/if}>已启用</option>
                            <option value="2" {if ($Think.get.status == 2)}selected{/if}>未启用</option>
                        </select>
                    </div>
                </div>

                <div class="b-fr">
                    <div class="formniuiwk">
                        <a href="javascript:void(0)" id="add" class="p-btn b-fr p-blue">添加</a>
                        <button type="submit" class="p-btn p-primary b-fr sousniu">搜索</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="p-panel">
    <table class="p-suppliertab">
        <thead>
            <th>工种</th>
            <th><a href="?{$order}&order_by=order_name">工人姓名<i class="fa {if ($Think.get.order == 'asc' and $Think.get.order_by == 'order_name')}fa-caret-up paixusort{elseif ($Think.get.order == 'desc' and $Think.get.order_by == 'order_name')}fa-caret-down  paixusort{else/}fa-caret-down{/if} paixu" aria-hidden="true"></i></a></th>
            <th>手机号</th>
            <th>施工状态</th>
            <th>最新工地</th>
            <th>历史工地数</th>
            <th><a href="?{$order}&order_by=order_time">创建时间<i class="fa {if ($Think.get.order == 'asc' and $Think.get.order_by == 'order_time')}fa-caret-up paixusort{elseif ($Think.get.order == 'desc' and $Think.get.order_by == 'order_time')}fa-caret-down paixusort{else/}fa-caret-down{/if} paixu" aria-hidden="true"></i></a></th>
            <th>启用状态</th>
            <th>操作</th>
        </thead>
        <tbody>
            {volist name='list.list' id='vo'}
            <tr>
                <td>{$vo.worktype_name}</td>
                <td>{$vo.contact_name}</td>
                <td>{$vo.contact_tel|default=''}</td>
                <td>
                    {if (isset($vo.build_count) && $vo.build_count>0)}
                    <a href="/shigong/" style="color:skyblue">{$vo.build_count|default=''}个进行中</a>
                    {else/}
                    <span class="p-nouse">空闲中</span>
                    {/if}
                </td>
                <td>{$vo.build_address|default=''}</td>
                <td>
                    <a href="/shigong/" style="color:skyblue">{$vo.count|default='0'}个</a>
                </td>
                <td>{$vo.create_time|date='Y-m-d H:i:s'}</td>
                <td>
                    {neq name="vo.status" value="1"}
                    <span style="color:red">未启用</span>
                    {else/}
                     <span style="color:green">已启用</span>
                    {/neq}
                </td>
                <td>
                    <a href="javascript:void(0)" class="p-eidt" data-id="{$vo.id}">编辑</a>
                    {eq name="vo.status" value="1"}
                     <a href="javascript:void(0)" class="prohibit" style="color:red" data-id="{$vo.id}">禁用</a>
                    {else/}
                    <a href="javascript:void(0)" class="enable" style="color:green" data-id="{$vo.id}">启用</a>
                    {/eq}
                    <span class="p-delete delete-group"  data-id="{$vo.id}">删除</span>
                </td>
            </tr>
            {/volist}
        </tbody>
    </table>
    {$list.page|raw|default=''}
</div>
<!-- 编辑Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">编辑工人</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id='editform'>
                    <div class="form-group">
                        <label for="editname" class="col-sm-3 control-label">工人姓名:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="editname" placeholder="请输入工人姓名" autocomplete="off"
                                maxlength="10">
                            <input type="hidden" id="edit_id">
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz editname col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="editmobile" class="col-sm-3 control-label">手机号:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="editmobile" placeholder="请输入工人手机号" maxlength="11">
                        </div>
                    </div>
                    <span class="yz editmobile col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="workmobile" class="col-sm-3 control-label">工种:</label>
                        <div class="col-sm-8">
                            <select class="p-input" name="g" id="editselect">
                                <option value="">请选择</option>
                                {volist name='worktypeSelect' id='vo'}
                                <option value="{$vo.id|default=''}" >{$vo.name}</option>
                                {/volist}
                            </select>
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz editselect col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="editaccount" class="col-sm-3 control-label">登录账号:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="editaccount" placeholder="请输入登录账号" maxlength="18">
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz editaccount col-sm-offset-3" style="color:red"></span>
                    <!-- <div class="form-group">
                        <label for="workpassword" class="col-sm-3 control-label">登录密码:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="workpassword" placeholder="请输入登录密码">
                        </div>
                        <span style="color:red">*</span>
                    </div> -->
                    <span class="yz col-sm-offset-3" style="color:red"></span>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="editsave">保存</button>
                <button type="button reset" id="resetpassword" class="btn btn-warning">重置密码</button>
            </div>
        </div>
    </div>
</div>

<!-- 添加Modal -->
<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">新增工人</h4>
            </div>
            <div class="modal-body">
                <form class="form-horizontal" id="addform">
                    <div class="form-group">
                        <label for="workname" class="col-sm-3 control-label">工人姓名:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="addname" placeholder="请输入工人姓名" autocomplete="off"
                                maxlength="10">
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz addname col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="workmobile" class="col-sm-3 control-label">手机号:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="addmobile" placeholder="请输入工人手机号" maxlength="11">
                        </div>
                    </div>
                    <span class="yz addmobile col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="workmobile" class="col-sm-3 control-label">工种:</label>
                        <div class="col-sm-8">
                            <select class="p-input" name="g" id="addselect">
                                <option value="">请选择</option>
                                {volist name='worktypeSelect' id='vo'}
                                <option value="{$vo.id|default=''}" >{$vo.name}</option>
                                {/volist}
                            </select>
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz addselect col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="workaccount" class="col-sm-3 control-label">登录账号:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="addaccount" placeholder="请输入登录账号" maxlength="18">
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz addaccount col-sm-offset-3" style="color:red"></span>
                    <div class="form-group">
                        <label for="workpassword" class="col-sm-3 control-label">登录密码:</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="addpassword" placeholder="请输入登录密码" maxlength="18">
                        </div>
                        <span style="color:red">*</span>
                    </div>
                    <span class="yz addpassword col-sm-offset-3" style="color:red"></span>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="addsave">保存</button>
            </div>
        </div>
    </div>
</div>

<!-- 重置密码弹框 -->
<div class="modal fade" id="resetModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">重置密码</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="workname" class="col-sm-3 control-label">设置新密码:</label>
                    <div class="col-sm-8">
                        <input type="password" class="form-control" id="newpass1" placeholder="请输入新密码" autocomplete="off"
                            maxlength="24">
                    </div>
                    <span style="color:red">*</span>
                </div>
                <span class="yz passtishi mima-tishi col-sm-offset-3" style="color:red"></span>
                <div class="form-group">
                    <label for="workname" class="col-sm-3 control-label">确认新密码:</label>
                    <div class="col-sm-8">
                        <input type="password" class="form-control" id="newpass2" placeholder="请输入新密码" autocomplete="off"
                            maxlength="24">
                    </div>
                    <span style="color:red">*</span>
                </div>
                <span class="yz passtishi sure-tishi col-sm-offset-3" style="color:red"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary" id="savepassword">保存</button>
            </div>
        </div>
    </div>
</div>

{/block}

{block name='script'}
<script type="text/javascript" src="/assets/pc/js/Plugin/select2/js/select2.min.js?v={:config('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/pc/js/Plugin/select2/js/zh-CN.js?v={:config('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/pc/js/Plugin/c_confirm.js?v={:config('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/pc/js/Plugin/bootstrap/js/bootstrap.min.js?v={:config('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/pc/js/Private/group.js?v={:config('STATIC_VERSION')}"></script>
<script type="text/javascript" src="/assets/pc/js/Plugin/select3/js/select3.js?v={:config('STATIC_VERSION')}"></script>

{/block}