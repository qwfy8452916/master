<style>
    .jsq_box{
        width: 261px; box-sizing: border-box;
        border:2px solid #ff5353;
        border-radius: 4px;
        padding:0px 20px;
    }
    .jsq_title{font-size: 20px;color: #ff5353; font-weight: bold;padding-top: 15px; padding-bottom: 5px; text-align: center;}
    .jsq_result{height: 60px; background: #4C5473; border-radius: 5px; color: #fff;position: relative;}
    .number_result{font-size: 40px; position: absolute; bottom:20; right: 30px }
    .danwei{font-size: 15px;position: absolute; bottom:12px; right: 10px;}
    .new_xsc_fadan{border:none; background: none}
    .new_xsc_fadan .fadan_form{padding: 15px 0px !important;}
    .new_xsc_fadan .input_line {
        height: 33px;
        background: #fff;
        margin-bottom: 11px;
        position: relative;
    }
    /*display: none;*/}
 .jisuanjieguo .kuangzi{width: 220px;margin:0 auto;height: auto;overflow: hidden;}
 .jisuanjieguo .kuangzi .zxjgy{text-align: center;font-size: 20px;color: #ff5353;margin-top: 10px;font-weight: bold;margin-bottom: 5px;}
 .jisuanjieguo .kuangzi .zxjgy2{font-size: 14px;color:#fff;text-align:right;background: #363c51;border-radius: 5px;height: 60px;
    line-height: 60px;padding-right: 10px;box-sizing: border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;}
 .jisuanjieguo .kuangzi .zxjgy2 span{font-size: 40px;color: #fff;}
 .jisuanjieguo .kuangzi .xiangxisj{padding: 22 26px;box-sizing: border-box;background: #fff;overflow: hidden;padding:0;box-sizing: border-box;}
 .jisuanjieguo .kuangzi .xiangxisj .otherxian{border-bottom: 0 !important;}
 .jisuanjieguo .kuangzi .xiangxisj .xiangxisj_biaod{font-size: 14px;color: #333;margin:0;overflow: hidden;
    border-bottom: 1px dashed #e6e6e6;height: 29px;line-height: 29px;}
 .jisuanjieguo .kuangzi .xiangxisj .xiangxisj_biaod span{font-size: 14px;color: #333;display: inline-block;
    width:auto;}
 .jisuanjieguo .kuangzi .xiangxisj .xiangxisj_biaod .lf{float: left;}
 .jisuanjieguo .kuangzi .xiangxisj .xiangxisj_biaod .rt{float: right;}
 .jisuanjieguo .kuangzi .xiangxisj .xiangxisj_biaod .rt span{margin-left: 5px;display: inline-block;}
 .jisuanjieguo .shuom{width:255px; background: #f5f5f5;padding: 0 20px; margin-left: -19px;
 box-sizing: border-box;-webkit-box-sizing:border-box;-moz-box-sizing:border-box; height: 71px;padding-top: 5px;}
 .jisuanjieguo .shuom span{color: #ff5353;}
</style>
<form id="fd_box_form" class="jsq_box" onsubmit="return false;">
    <div class="new_xsc_fadan">
        <div class="jsq_title">8秒估算装修报价</div>
        <div class="jsq_result">
            <span class="danwei">元</span>
            <span class="number_result">142335</span>
        </div>
        <div class="fadan_form">
            <div class="input_line two_input">
                <select id="f_bj_cs" name="cs" class="pull-left"></select>
                <select id="f_bj_qx" class="pull-right" name="qx" class="pull-right"></select>
            </div>
            <i class='valdatemsg one'></i>
            <div class="input_line ">
                <input type="text" name="mianji" placeholder="输入您的房屋面积"  />
                <i class="order-icon">㎡</i>
            </div>
            <i class='valdatemsg two'></i>
            <div class="input_line ">
                <input type="text" name="tel" placeholder="输入手机号获取报价结果" maxlength="11" />

             </div>
             <i class='valdatemsg three'></i>
            <div class="input_line ">
                <input type="text" name="xiaoqu" placeholder="输入您的小区以便准确匹配"  />

             </div>
            <i class='valdatemsg four'></i>

            <!--S-免责申明-->
                <include file="Common@Order/disclamer"/>
            <!--E-免责申明-->
            <div class="input_line">
                <button tab-index="0" data-type="2"  type="button" id="tijiao_fadan">立即计算</button>
            </div>
            <input type="hidden" name="fb_type" value="baojia">
        </div>

    </div>

    <div class="jisuanjieguo" style="display:none;">
        <div class="kuangzi">
            <div class="zxjgy">您的装修预算为：</div>
            <div class="zxjgy2"><span id="total-price">6.8</span>万元</div>
            <div class="xiangxisj">
                <div class="xiangxisj_biaod"><span class="lf">客厅</span><span class="rt"><span id="kt-price"></span><span>元</span></span></div>
                <div class="xiangxisj_biaod"><span class="lf">卧室</span><span class="rt"><span id="zw-price"></span><span>元</span></span></div>
                <div class="xiangxisj_biaod"><span class="lf">厨房</span><span class="rt"><span id="cf-price"></span><span>元</span></span></div>
                <div class="xiangxisj_biaod"><span class="lf">卫生间</span><span class="rt"><span id="wsj-price"></span><span>元</span></span></div>
                <div class="xiangxisj_biaod"><span class="lf">水电</span><span class="rt"><span id="sd-price"></span><span>元</span></span></div>
                <div class="xiangxisj_biaod otherxian"><span class="lf">其它</span><span class="rt"><span id="other-price"></span><span>元</span></span></div>
            </div>
        </div>
        <div class="shuom"><span>*</span>因材料品牌及工程量不同,具体的价格由实际工程为准;稍后齐装网客服会给您提供更多的报价详情</div>
    </div>
</form>

<script type="text/javascript">
var shen = null,shi = null;
shen = citys["shen"];
shi = citys["shi"];

var ip_cityid = '{$Think.cookie.iplookup}';
var city_id = '{$theCityId}';
(city_id == '') ? cityId = ip_cityid : cityId = city_id;
if(cityId == ''){
    getLocation();
}else{
    initCity(cityId);
}
setInterval(function(){
    var randomResult=parseInt(Math.random() * 90000+ 30000);
    $('.number_result').html(randomResult);
},300)
function initCity(cityId){
    App.citys.init("#f_sj_cs","#f_sj_qx",shen,shi,cityId);
    App.citys.init("#f_bj_cs","#f_bj_qx",shen,shi,cityId);
}
$(function(){
    var container = $("#fd_box_form .new_xsc_fadan .fadan_form");

    $("#tijiao_fadan").click(function(event) {
        var disclamer =$(".new_xsc_fadan .disclamer-check").attr("data-checked");
        $(".valdatemsg").html('').css('display','none');

        if (!App.validate.run($("#f_bj_cs", container).val())) {
            $("#f_bj_cs", container).addClass('focus').focus();
            $(".fadan_form .one").html('请选择您的城市').css('display','block');
            return false;
        }
        if (!App.validate.run($("#f_bj_qx", container).val())) {
            $("#f_bj_qx", container).addClass('focus').focus();
            $(".fadan_form .one").html('请选择您的区域').css('display','block');
            return false;
        }

       if (!App.validate.run($("input[name=mianji]", container).val())) {
            $("input[name=mianji]", container).addClass('focus').focus();
            $(".fadan_form .two").html('请输入您的住房面积').css('display','block');
            return false;
        }else{
            if(isNaN($("input[name=mianji]", container).val())){
                $("input[name=mianji]", container).addClass('focus').focus();
                $(".fadan_form .two").html('面积必须是数字').css('display','block');
                return false;
            }
            if ($("input[name=mianji]", container).val()>10000||$("input[name=mianji]", container).val()<1) {
                $("input[name=mianji]", container).addClass('focus').focus();
                $(".fadan_form .two").html('面积填写1~10000的数字!').css('display','block');
                return false;
            }
        }

         if (!App.validate.run($("input[name=tel]", container).val())) {
                $("input[name=tel]", container).addClass('focus').focus();
                $(".fadan_form .three").html('请填写手机号码 ^_^!').css('display','block');
                return false;
            } else {
                var reg = new RegExp("^(130|131|132|155|156|185|186|145|176|175" +
                "|139|138|137|136|135|134|147|150|151|152|157|158|159|178|182|183|184|187|188" +
                "|133|153|177|173|180|181|189)[0-9]{8}$");
                if (!reg.test($("input[name=tel]", container).val())) {
                    $("input[name=tel]", container).addClass('focus').focus();
                    $(".fadan_form .three").html('请填写正确的手机号码 ^_^!').css('display','block');
                    return false;
                }
            }
        if(!App.validate.run($("input[name=xiaoqu]", container).val())){
             $("input[name=xiaoqu]", container).addClass('focus').focus();
             $(".fadan_form .four").html('请填写小区名称 ^_^!').css('display','block');
             return false;
        }else{
            var reg= /^[0-9]+(.[0-9]{1,2})?$/gi;
            if(reg.test($("input[name=xiaoqu]", container).val())){
                $(".fadan_form .four").html('请填写正确的小区名称 ^_^!').css('display','block');
                return false;
            }
        }

        if(disclamer=="false"){
            alert("请勾选我已阅读并同意齐装网的《免责申明》！");
            return false;
        }
        var data = {
           tel:$("input[name=tel]",container).val(),
           fb_type:$("input[name=fb_type]",container).val(),
           cs:$("select[name=cs]",container).val(),
           qx:$("select[name=qx]",container).val(),
           mianji:$("input[name=mianji]",container).val(),
           xiaoqu:$("input[name=xiaoqu]",container).val()
        };
        window.order({
            extra : data,
            error:function(data){ alert("网络发生错误,请稍后重试！");},
            success:function(data, status, xhr){
               if (data.status == 1) {
                    $.ajax({
                        url: '/getdetailsbyajax/',
                        type: 'GET',
                        dataType: 'JSON'
                    })
                    .done(function (data) {
                        if (data.status == 1) {
                            calculate(data.data);

                             $('.new_xsc_fadan').hide();
                             $('.jisuanjieguo').show()
                        } else {
                            alert(data.info);
                        }
                    })
                    .fail(function (xhr) {
                        alert('获取报价失败,请刷新页面');
                    });
                }else{
                    alert("发生错误,请稍后重试！");
                }
            },
            validate:function(item, value, method, info){
                return true;
            }
        });

         function calculate(data) {
            $('#kt-price').text(data.kt);
            $('#zw-price').text(data.zw);
            $('#wsj-price').text(data.wsj);
            $('#cf-price').text(data.cf);
            $('#sd-price').text(data.sd);
            $('#other-price').text(data.other);
            $('#total-price').text(data.total / 10000);
        }
    });
});
</script>