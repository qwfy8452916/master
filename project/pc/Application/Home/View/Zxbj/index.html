<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
    <title>在线智能报价_轻松获得精确预算_躲避装修猫腻</title>
    <meta name="keywords" content="装修公司,装修网,装修效果图,装饰,齐装网" />
    <meta name="description" content="齐装网是中国家居装修装饰门户网站，汇集了全国性价比较高的家居装修装饰公司，为您提供专业的装修服务以及全新的装修设计效果图、案例和装修知识；专业服务、品质保障，让您的装修更安心！" />
    <include file="Index:resource"/>
    <link href="{$static_host}/assets/home/zxbj/css/default.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link href="{$static_host}{$static_host}/assets/common/css/popVerify.css?v={:C('STATIC_VERSION')}" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="{$static_host}/assets/user/home/css/font-awesome.min.css?v={:C('STATIC_VERSION')}" />
    <script type="text/javascript" src="{$static_host}/assets/common/js/popVerify.js?v={:C('STATIC_VERSION')}"></script>
    <link rel="stylesheet" href="{$static_host}/assets/common/css/step.css?v={:C('STATIC_VERSION')}" />
    <link rel="stylesheet" href="{$static_host}/assets/user/home/css/font-awesome.min.css?v={:C('STATIC_VERSION')}" />
</head>
<body>
    {$headerTmp}
    <div class="wrap">
        <img src="{$static_host}/assets/home/zxbj/img/znbj_1.jpg" width="1210" height="144">
    </div>
    <div class="wrap mt20 zjmain">
        <div class="znbjmain znbjinfo">
            <h1>房屋基础信息</h1>
            <h2>今天已经有<i>{:releaseCount("fbrs")}</i>位业主免费成功获取在线报价</h2>
            <ul>
                <li>
                    <span>装修种类：</span>
                    <if condition="!$info['order'] OR $info['order']['lxs'] EQ 1">
                        <input name="lxs" type="radio" name="lxs" id="house1" class="icheck" value="1" checked>
                        <label for="house1">新房装修</label>
                        <input id="house2" name="lxs" type="radio" class="icheck" value="2">
                        <label for="house2">二手房装修</label>
                    <else/>
                        <input name="lxs" type="radio" name="lxs" id="house1" class="icheck" value="1" >
                        <label for="house1">新房装修</label>
                        <input id="house2" name="lxs" type="radio" class="icheck" value="2" checked>
                        <label for="house2">二手房装修</label>
                    </if>
                    <div class="tip"></div>
                </li>
                <li>
                    <span>装修档次：</span>
                    <if condition="$info['order'] AND $info['order']['zxdc'] EQ 1">
                        <input name="zxdc" type="radio" id="plan1" class="icheck" value="1" checked>
                        <label for="plan1">简装</label>
                        <input name="zxdc" type="radio" class="icheck" id="plan2" value="2" >
                        <label for="plan2">精装</label>
                        <input id="plan3" name="zxdc"  type="radio" class="icheck"  value="3">
                        <label for="plan3">豪装</label>
                    <elseif condition="!isset($info['order']) OR $info['order']['zxdc'] EQ 2"/>
                        <input name="zxdc" type="radio" id="plan1" class="icheck" value="1">
                        <label for="plan1">简装</label>
                        <input name="zxdc" type="radio" class="icheck" id="plan2" value="2" checked>
                        <label for="plan2">精装</label>
                        <input id="plan3" name="zxdc"  type="radio" class="icheck"  value="3">
                        <label for="plan3">豪装</label>
                    <elseif condition="$info['order'] AND $info['order']['zxdc'] EQ 3"/>
                        <input name="zxdc" type="radio" id="plan1" class="icheck" value="1">
                        <label for="plan1">简装</label>
                        <input name="zxdc" type="radio" class="icheck" id="plan2" value="2" >
                        <label for="plan2">精装</label>
                        <input id="plan3" name="zxdc"  type="radio" class="icheck"  value="3" checked>
                        <label for="plan3">豪装</label>
                    </if>
                    <div class="tip"></div>
                </li>
                <li>
                    <span>房屋面积：</span>
                    <input name="mianji" type="text" class="type" placeholder="面积" value="{$info.order.mianji}"> 平方米
                    <div class="tip"></div>
                </li>
                <li>
                    <span>房屋地址：</span>
                    <select id="cs" name="cs">
                    </select>
                    <select id="qy" name="qy">
                    </select>
                    <input  type="text" class="type" placeholder="小区" style="width:200px;" name="xiaoqu" value="{$info.order.xiaoqu}">
                    <div class="tip"></div>
                </li>
                <li class="hx">
                    <span>房屋户型：</span>
                    <select name="huxing" style="width:120px;">
                        <volist name="info.hx" id="vo">
                            <if condition="(isset($info['order']) AND $vo['id'] EQ $info['order']['huxing']) OR (!isset($info['order']) AND $vo['id'] EQ 43)">
                                <option value="{$vo.id}" selected="selected">{$vo.name}</option>
                            <else/>
                                <option value="{$vo.id}">{$vo.name}</option>
                            </if>
                        </volist>
                    </select>
                    <select id="house_shi" name="shi">
                        <volist name="info.shi" id="vo">
                            <if condition="$info['order']['shi'] EQ $vo OR (!isset($info['order']) AND $key EQ 0 )">
                                <option selected="selected">{$vo}</option>
                            <else/>
                                <option>{$vo}</option>
                            </if>
                        </volist>
                    </select>
                    <label for="house_shi">室</label>
                    <select id="house_ting" name="ting">
                        <volist name="info.ting" id="vo">
                            <if condition="$info['order']['ting'] EQ $vo OR (!isset($info['order']) AND $key EQ 0 )">
                                <option selected="selected">{$vo}</option>
                            <else/>
                                <option>{$vo}</option>
                            </if>
                        </volist>
                    </select>
                    <label for="house_ting">厅</label>
                    <select id="house_wei" name="wei">
                        <volist name="info.wei" id="vo">
                            <if condition="$info['order']['wei'] EQ $vo OR (!isset($info['order']) AND $key EQ 0 )">
                                <option selected="selected">{$vo}</option>
                            <else/>
                                <option>{$vo}</option>
                            </if>
                        </volist>
                    </select>
                    <label for="house_wei">卫</label>
                    <select id="house_chu" name="chu">
                        <volist name="info.chu" id="vo">
                            <if condition="$info['order']['chu'] EQ $vo OR (!isset($info['order']) AND $key EQ 0)">
                                <option selected="selected">{$vo}</option>
                            <else/>
                                <option>{$vo}</option>
                            </if>
                        </volist>
                    </select>
                    <label for="house_chu">厨</label>
                    <select id="house_yangtai" name="yangtai">
                        <volist name="info.yangtai" id="vo">
                            <if condition="$info['order']['yangtai'] EQ $vo OR (!isset($info['order']) AND $key EQ 0 )">
                                <option selected="selected">{$vo}</option>
                            <else/>
                                <option>{$vo}</option>
                            </if>
                        </volist>
                    </select>
                    <label for="house_yangtai">阳台</label>
                    <div class="tip"></div>
                </li>
            </ul>
            <if condition="$details">
                <button class="botton" disabled="disabled">估算报价</button>
                <script type="text/javascript">
                    $(function(){
                        $(".znbjinfo").find("input,select,button").attr("disabled","disabled");
                    });
                </script>
            <else/>
                <button id="btnNext" class="botton">获取报价</button>
            </if>
        </div>
        <div class="details-panel">
            {$details}
        </div>
    </div>
    <input id="safecode" type="hidden" value="{$safecode}" />
    <input id="safekey" type="hidden" value="{$safekey}" />
    <include file="Index:footer"/>
</body>
<script type="text/javascript">
    var shen = null,shi = null;
    shen = citys["shen"];
    shi = citys["shi"];
    App.citys.init("#cs","#qy",shen,shi,"{$info.cityId}","{$info.order.qx}");
    $(".znbjinfo").find("input,select,button").attr("disabled",false);
    $(function(){
        $("input[name='mianji']").focus();
        document.documentElement.scrollTop = 300;

        $('.icheck').iCheck({
            checkboxClass: 'icheckbox_minimal-red',
            radioClass: 'iradio_minimal-red',
            increaseArea: '' // optional
        });

        $("#btnStep").click(function(event) {
            getTemplate($(this));
        });

        function getTemplate(target){
            var _this = target;
            var zxdc = "{$info.order.zxdc}" =="" ? $(".znbjinfo input[name=zxdc]:checked").val():"{$info.order.zxdc}";
            var mianji = "{$info.order.mianji}" == ""?$(".znbjinfo input[name=mianji]").val():"{$info.order.mianji}";
            $.ajax({
                url: '/getconstructionprice',
                type: 'POST',
                dataType: 'JSON',
                data: {
                    shi:$(".znbjinfo select[name=shi]").val(),
                    ting:$(".znbjinfo select[name=ting]").val(),
                    wei:$(".znbjinfo select[name=wei]").val(),
                    chu:$(".znbjinfo select[name=chu]").val(),
                    yangtai:$(".znbjinfo select[name=yangtai]").val(),
                    mianji:mianji,
                    zxdc:zxdc,
                    cs:$(".znbjinfo select[name=cs]").val(),
                    id:"{$info.order.id}"
                }
            })
            .done(function(data) {
                if(data.status == 1){
                    $(".zjmain .details-panel").html(data.data);
                }else{
                    $.pt({
                        target: _this,
                        content: data.info,
                        width: 'auto'
                    });
                }
            })
            .fail(function(xhr) {
                $.pt({
                    target: _this,
                    content: '获取失败,请稍后再试!',
                    width: 'auto'
                });
            });
        }

        $("select[name=huxing]").change(function(event) {
            var _this = $(this);
            var shi = 1;
            var ting = 1;
            var wei = 1;

            if( _this.val() >= 38 && _this.val() <= 50){
                switch (_this.val()) {
                    case '38':
                        shi = "1";
                        ting = "1";
                        wei = "1";
                        break;
                    case '39':
                        shi = "2";
                        ting = "1";
                        wei = "1";
                        break;
                    case '40':
                       shi = "2";
                        ting = "2";
                        wei = "1";
                        break;
                    case '41':
                        shi = "2";
                        ting = "2";
                        wei = "2";
                        break;
                    case '42':
                        shi = "3";
                        ting = "2";
                        wei = "1";
                        break;
                    case '43':
                        shi = "3";
                        ting = "2";
                        wei = "2";
                        break;
                    case '46':
                        shi = "3";
                        ting = "2";
                        wei = "2";
                        break;
                    case '47':
                        shi = "3";
                        ting = "2";
                        wei = "1";
                        break;
                    case '48':
                        shi = "4";
                        ting = "2";
                        wei = "2";
                        break;
                    case '49':
                        shi = "5";
                        ting = "2";
                        wei = "2";
                        break;
                    case '50':
                        shi = "6";
                        ting = "2";
                        wei = "3";
                        break;
                }
            }
            $("select[name=shi]").val(shi);
            $("select[name=ting]").val(ting);
            $("select[name=wei]").val(wei);
        });
        $("select[name=huxing]").trigger('change');
        $("#btnNext").click(function(event) {
            $(".tip").html("");
            var _this = $(this);
            $(".focus").removeClass('focus');
            if(!App.validate.run($(".znbjinfo input[name=mianji]").val(),"string")){
                $(".znbjinfo input[name=mianji]").focus();
                $(".znbjinfo input[name=mianji]").addClass('focus');
                $(".znbjinfo input[name=mianji]").parent().find(".tip").html("请填写面积");
                return false;
            }

            if(!App.validate.run($(".znbjinfo input[name=mianji]").val(),"decimal")){
                $(".znbjinfo input[name=mianji]").focus();
                $(".znbjinfo input[name=mianji]").addClass('focus');
                $(".znbjinfo input[name=mianji]").parent().find(".tip").html("非法的面积数据");
                return false;
            }

            if(!App.validate.run($(".znbjinfo select[name=cs]").val(),"string")){
                $(".znbjinfo select[name=cs]").focus();
                $(".znbjinfo select[name=cs]").addClass('focus');
                $(".znbjinfo select[name=cs]").parent().find(".tip").html("请选择省/市");
                return false;
            }

            if(!App.validate.run($(".znbjinfo select[name=qy]").val(),"string")){
                $(".znbjinfo select[name=qy]").focus();
                $(".znbjinfo select[name=qy]").addClass('focus');
                $(".znbjinfo select[name=qy]").parent().find(".tip").html("请选择市/地区");
                return false;
            }

            if(!App.validate.run($(".znbjinfo input[name=xiaoqu]").val(),"string")){
                $(".znbjinfo input[name=xiaoqu]").focus();
                $(".znbjinfo input[name=xiaoqu]").addClass('focus');
                $(".znbjinfo input[name=xiaoqu]").parent().find(".tip").html("请填写小区");
                return false;
            }

            var savedata = {
                lxs:$(".znbjinfo input[name=lxs]:checked").val(),
                zxdc:$(".znbjinfo input[name=zxdc]:checked").val(),
                mianji:$(".znbjinfo input[name=mianji]").val(),
                cs:$(".znbjinfo select[name=cs]").val(),
                qx:$(".znbjinfo select[name=qy]").val(),
                xiaoqu:$(".znbjinfo input[name=xiaoqu]").val(),
                huxing:$(".znbjinfo select[name=huxing]").val(),
                shi:$(".znbjinfo select[name=shi]").val(),
                ting:$(".znbjinfo select[name=ting]").val(),
                wei:$(".znbjinfo select[name=wei]").val(),
                chu:$(".znbjinfo select[name=chu]").val(),
                yangtai:$(".znbjinfo select[name=yangtai]").val(),
                source:30,
                safecode:$("#safecode").val(),
                ssid:"{$ssid}",
                safekey:$("#safekey").val()
            }
            App.FB.init(savedata,function(){
                $(".znbjinfo").find("input,select,button").attr("disabled","disabled");
                getTemplate(_this);
            });
        });
    });
</script>
</html>
